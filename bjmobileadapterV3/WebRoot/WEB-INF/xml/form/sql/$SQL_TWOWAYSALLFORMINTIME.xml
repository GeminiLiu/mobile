<?xml version="1.0" encoding="GB2312"?>
<sql-group>
	<doc>
		<author>duanximeng</author>
		<date>2006-05-21</date>
		<description>
		</description>
	</doc>
	<!-- 派发人到受理人-->
	<sql name="hbeoms.twowaysallformintimepfrolenametorolename" datasource="Ultranms">
		<item dbms="All"><![CDATA[
		
select 
t.C700000004 || '-->' ||pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) || '' as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
group by t.C700000004,pro.C700020009--,t.C700000014,
union all
select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'处理及时',
count(distinct(t.C1)) || '' as 处理及时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020017-pro.c700020014<=0
group by t.C700000004,pro.C700020009--,t.C700000014,
union all
select 
 a.人员派给人员, 
 '处理及时率', 
 round(b.处理及时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理及时率 
 from 
(select 
t.C700000004 || '-->' ||pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
group by t.C700000004,pro.C700020009--,t.C700000014,
) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'处理及时',
count(distinct(t.C1)) as 处理及时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020017-pro.c700020014<=0
group by t.C700000004,pro.C700020009--,t.C700000014,
) b
where a.人员派给人员=b.人员派给人员
union all
select 
t.C700000004 || '-->' || pro.C700020009 as 处理人,
'处理超时',
count(distinct(t.C1)) || '' as 处理超时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020017-pro.c700020014>0
group by t.C700000004,pro.C700020009--,t.C700000014,
union all
select 
 a.人员派给人员, 
 '处理超时率', 
 round(b.处理超时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理超时率 
 from 
(select 
t.C700000004 || '-->' ||pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
group by t.C700000004,pro.C700020009--,t.C700000014,
) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'处理超时',
count(distinct(t.C1)) as 处理超时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020017-pro.c700020014>0
group by t.C700000004,pro.C700020009--,t.C700000014,
) b
where a.人员派给人员=b.人员派给人员

union all

select 
t.C700000004 || '-->' || pro.C700020009 as 处理人,
'其他的工单',
count(distinct(t.C1)) || '' as 其他的工单
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and (pro.c700020014 is null or pro.c700020017 is null)
group by t.C700000004,pro.C700020009--,t.C700000014,
union all
select 
 a.人员派给人员, 
 '其他的工单比率', 
 round(b.其他的工单/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 其他的工单比率 
 from 
(select 
t.C700000004 || '-->' ||pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
group by t.C700000004,pro.C700020009--,t.C700000014,
) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'其他的工单',
count(distinct(t.C1)) as 其他的工单
from {1000} t,(select * from {800} union all select * from {900}) pro ,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020004<>'BEGIN'
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and (pro.c700020014 is null or pro.c700020017 is null)
group by t.C700000004,pro.C700020009--,t.C700000014,
) b
where a.人员派给人员=b.人员派给人员
		]]></item>
	</sql>
		<!-- 派发人到受理人-->
	<sql name="hbeoms.twowaysallformintimepfrolenametorolename_yrow" datasource="Ultranms">
		<item dbms="All"><![CDATA[
		select
(a.派单人||'-->'||
b.处理人) as 人派给人
from
(select distinct(u.c630000003) as 派单人 from {300} u where 1=1 {2}) a,
(select distinct(u.c630000003) as 处理人 from {300} u where 1=1 {4}) b
order by a.派单人
		]]></item>
	</sql>
	<!-- 派发人到受理部门
	t.c700000004=uu.c630000003
and uu.c1='000000000001942'
	 -->
		<sql name="hbeoms.twowaysallformintimesendpfrolenametosendscopename" datasource="Ultranms">
		<item dbms="All"><![CDATA[
		select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '工单总数', 
		 count(distinct(t.C1)) || '' as 工单总数 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
         {4}
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN'  
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 union all 
		 select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '处理及时', 
		 count(distinct(t.C1)) || '' as 处理及时 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  

		 {3}
		 {4}
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN' 
		 and pro.c700020017-pro.c700020014<=0 
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 union all 
		 select 
		 a.人员派给部门, 
		 '处理及时率', 
		 round(b.处理及时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理及时率 
		 from 
		 (select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '工单总数', 
		 count(distinct(t.C1)) as 工单总数 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
		 {4}
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN'  
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 ) a, 
		 (select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '处理及时', 
		 count(distinct(t.C1)) as 处理及时 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
		 {4} 
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN' 
		 and pro.c700020017-pro.c700020014<=0 
		 --and t.C700000014='彩信' 
		 --and pro.C700020001='000000000006972' 
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 ) b 
		 where a.人员派给部门=b.人员派给部门 
		 union all 
		 select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '处理超时', 
		 count(distinct(t.C1)) || '' as 处理超时 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
		 {4}
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN' 
		 and pro.c700020017-pro.c700020014>0 
		 --and t.C700000014='彩信' 
		 --and pro.C700020001='000000000006972' 
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 union all 
		 select 
		 a.人员派给部门, 
		 '处理超时率', 
		 round(b.处理超时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理超时率 
		 from 
		 (select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '工单总数', 
		 count(distinct(t.C1)) as 工单总数 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2} 
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
		 {4} 
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN' 
		 --and t.C700000014='彩信' 
		 --and pro.C700020001='000000000006972' 
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 ) a, 
		 (select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '处理超时', 
		 count(distinct(t.C1)) as 处理超时 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
		 {4}
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN' 
		 and pro.c700020017-pro.c700020014>0 
		 --and t.C700000014='彩信' 
		 --and pro.C700020001='000000000006972' 
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 ) b 
		 where a.人员派给部门=b.人员派给部门 		 
		 union all 		 
		 select 
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门,
		 '其他的工单',
		 count(distinct(t.C1)) || '' as 其他的工单
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
		 where
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001 
		 and g.C1=gu.C620000027
		 and gu.C620000028=u.C1
		 {3}
		 {4}
		 and u.C630000003=pro.C700020009
		 and (pro.c700020011='已完成' or pro.C700020011='已派发')
		 and pro.c700020004<>'BEGIN'
		 and (pro.c700020017 is null or pro.c700020014 is null)
		 group by t.C700000004,g.C630000018--,t.C700000014		
		 union all		
		 select 
		 a.人员派给部门, 
		 '其他的工单比率', 
		 round(b.其他的工单/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 其他的工单比率 
		 from 
		 (select  
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门, 
		 '工单总数', 
		 count(distinct(t.C1)) as 工单总数 
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu 
		 where 
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001  
		 and g.C1=gu.C620000027 
		 and gu.C620000028=u.C1 
		 {3}
		 {4} 
		 and u.C630000003=pro.C700020009 
		 and (pro.c700020011='已完成' or pro.C700020011='已派发') 
		 and pro.c700020004<>'BEGIN' 
		 --and t.C700000014='彩信' 
		 --and pro.C700020001='000000000006972' 
		 group by t.C700000004,g.C630000018--,t.C700000014 
		 ) a,
		 (select 
		 t.C700000004 || '-->' ||g.C630000018 as 人员派给部门,
		 '其他的工单',
		 count(distinct(t.C1)) as 其他的工单
		 from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu ,{300} uu
		 where
		 t.c700000004=uu.c630000003
		 and t.c700000001=pro.c700020002
		 {1}
		 {2}
		 and t.C1=pro.C700020001 
		 and g.C1=gu.C620000027
		 and gu.C620000028=u.C1
		 {3}
		 {4}
		 and u.C630000003=pro.C700020009
		 and (pro.c700020011='已完成' or pro.C700020011='已派发')
		 and pro.c700020004<>'BEGIN'
		 and (pro.c700020014 is null or pro.c700020017 is null)
		 group by t.C700000004,g.C630000018--,t.C700000014
		 ) b
		 where a.人员派给部门=b.人员派给部门
		]]></item>
	</sql>
	<!-- 派发人到受理部门yrow -->
		<sql name="hbeoms.twowaysallformintimesendpfrolenametosendscopename_yrow" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
(a.派单人||'-->'||
b.处理组) as 人派给部门
from
(select distinct(uu.c630000003) as 派单人 from {300} uu where 1=1 {2}) a,
(select g.C630000018 as 处理组 from {400} g where 1=1 {4}) b
		]]></item>
	</sql>
	<!-- 派发组到受理人-->
		<sql name="hbeoms.twowaysallformintimepfsendscopenametorolename" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) || '' as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
group by g.C630000018,pro.C700020009--,t.C700000014
union all
select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'处理及时',
count(distinct(t.C1)) || '' as 处理及时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
and pro.c700020017-pro.c700020014<=0
group by g.C630000018,pro.C700020009

union all

select 
 a.部门派给人员, 
 '处理及时率', 
 round(b.处理及时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理及时率 
 from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'处理及时',
count(distinct(t.C1)) as 处理及时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
and pro.c700020017-pro.c700020014<=0
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员

union all

select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'处理超时',
count(distinct(t.C1)) || '' as 处理超时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
and pro.c700020017-pro.c700020014>0
group by g.C630000018,pro.C700020009--,t.C700000014

union all

select 
 a.部门派给人员, 
 '处理超时率', 
 round(b.处理超时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理超时率 
 from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'处理超时',
count(distinct(t.C1)) as 处理超时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
and pro.c700020017-pro.c700020014>0
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员

union all

select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'其他的工单',
count(distinct(t.C1)) || '' as 其他的工单
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
and (pro.c700020014 is null or pro.c700020017 is null)
group by g.C630000018,pro.C700020009--,t.C700000014
union all
select 
 a.部门派给人员, 
 '其他的工单比率', 
 round(b.其他的工单/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 其他的工单比率 
 from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'其他的工单',
count(distinct(t.C1)) as 其他的工单
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN' 
and (pro.c700020014 is null or pro.c700020017 is null)
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员
		]]></item>
	</sql>
	<!-- 派发组到受理人yrow-->
		<sql name="hbeoms.twowaysallformintimepfsendscopenametorolename_yrow" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
(a.派单组||'-->'||
b.处理人) as 组派给人
from
(select g.C630000018 as 派单组 from {400} g where 1=1 {5}) a,
(select distinct(u.c630000003) as 处理人 from {300} u where 1=1 {6}) b
order by a.派单组
		]]></item>
	</sql>
	<!-- 派发组到处理组-->
		<sql name="hbeoms.twowaysallformintimesendpfscopenametoscopename" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) ||'' as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN'
group by g.C630000018,gg.C630000018

union all

select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'处理及时',
count(distinct(t.C1)) || '' as 处理及时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.c700020011='已派发')
and pro.c700020004<>'BEGIN'
and pro.c700020017-pro.c700020014<=0
group by g.C630000018,gg.C630000018

union all

select
a.部门派给部门,
'处理及时率',
round(b.处理及时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理及时率
from
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN'
group by g.C630000018,gg.C630000018) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'处理及时',
count(distinct(t.C1)) as 处理及时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.c700020011='已派发')
and pro.c700020004<>'BEGIN'
and pro.c700020017-pro.c700020014<=0
group by g.C630000018,gg.C630000018) b
where a.部门派给部门=b.部门派给部门

union all

select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'处理超时',
count(distinct(t.C1)) || '' as 处理超时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN'
and pro.c700020017-pro.c700020014>0
group by g.C630000018,gg.C630000018

union all

select
a.部门派给部门,
'处理超时率',
round(b.处理超时/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 处理超时率
from
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN'
group by g.C630000018,gg.C630000018) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'处理超时',
count(distinct(t.C1)) as 处理超时
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.c700020011='已派发')
and pro.c700020004<>'BEGIN'
and pro.c700020017-pro.c700020014>0
group by g.C630000018,gg.C630000018) b
where a.部门派给部门=b.部门派给部门
 
union all

select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'其他的工单',
count(distinct(t.C1)) || '' as 其他的工单
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020014 is null or pro.c700020017 is null)
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN'
--and t.C700000014='彩信'
--and pro.C700020001='000000000006972'
group by g.C630000018,gg.C630000018

union all

select
a.部门派给部门,
'其他的工单比率',
round(b.其他的工单/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 其他的工单比率
from
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.C700020011='已派发')
and pro.c700020004<>'BEGIN'
group by g.C630000018,gg.C630000018) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'其他的工单',
count(distinct(t.C1)) as 其他的工单
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{2}
--and (g.C630000018='技术支持部门' or g.C630000018='网管中心')
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1
{3}{4}
--and (gg.C630000018='北区客服' or gg.C630000018='网管中心')
and uu.C630000003=pro.C700020009
and (pro.c700020011='已完成' or pro.c700020011='已派发')
and pro.c700020004<>'BEGIN'
and (pro.c700020014 is null or pro.c700020017 is null)
group by g.C630000018,gg.C630000018) b
where a.部门派给部门=b.部门派给部门

		]]></item>
	</sql>
		<!-- 派发组到受理部门yrow-->
		<sql name="hbeoms.twowaysallformintimesendpfscopenametoscopename_yrow" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
a.派单组||'-->'||b.处理组 as 部门派发部门
from
(select g.C630000018 as 派单组 from {400} g where 1=1 {5}) a,
(select gg.C630000018 as 处理组 from {400} gg where 1=1 {6}) b
		]]></item>
	</sql>
		<sql name="hbeoms.titlename" datasource="Ultranms">
		<item dbms="All"><![CDATA[
  
select 't'||t.schemaid,BaseCategory.C650000001 as basechname, BaseCategory.C650000002 as basename from {500} BaseCategory,arschema t
where  t.name=BaseCategory.C650000002 and t.schemaid={5}
		]]></item>
	</sql>
</sql-group>


<?xml version="1.0" encoding="GB2312"?>
<sql-group>
	<doc>
		<author>shenchuan</author>
		<date>2008-07-09</date>
		<description>管道资源季报表</description>
	</doc>
	<sql name="pipelinequarterlypage.group" datasource="Ultranms">
		<item dbms="All"><![CDATA[

			select t.groupname from (
			select g.c630000018 groupname  from {100} g where g.c630000021='2' and g.c630000020='000000000600001' and g.c630000027='1'
			union all 
			select trim('网管中心') groupname from dual
			) t 
		]]></item>
	</sql>
	<sql name="pipelinequarterly.left" datasource="Ultranms">
		<item dbms="All"><![CDATA[

			select ' ',t.groupname as 公司 from (
			select g.c630000018 groupname  from {100} g where g.c630000021='2' and g.c630000020='000000000600001' and g.c630000027='1'
			union all 
			select trim('网管中心') groupname from dual
			) t where 1=1 {1}
		]]></item>
	</sql>
	

		<sql name="pipelinequarterly.colTitle" datasource="Ultranms">
		<item dbms="All"><![CDATA[
					select trim('自建管道') 
					  from dual
					union all
					select trim('自建管孔')
					  from dual
					union all
					select trim('自建子管') 
					  from dual
					union all
					select trim('租用管道') 
					  from dual
				     union all
					select trim('租用管孔')
					from dual
					union all
					select trim('租用子管') 
					  from dual
					  union all
					select trim('其他管道') 
					  from dual
				     union all
					select trim('其他管孔')
					from dual
					union all
					select trim('其他子管') 
					  from dual
					  union all
					select trim('合计管道') 
					  from dual
				     union all
					select trim('合计管孔')
					from dual
					union all
					select trim('合计子管') 
					  from dual
					  union all
					select trim('自建比例管道') 
					  from dual
				     union all
					select trim('自建比例管孔')
					from dual
					union all
					select trim('自建比例子管') 
					  from dual
					  
		]]></item>
	</sql>
		<sql name="pipelinequarterly.centervalue" datasource="Ultranms">
		<item dbms="All"><![CDATA[

				select trim('自建管道'),t.c802000002 as 所属城市,nvl(sum(t.c802000004),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('自建管孔'),t.c802000002 as 所属城市,nvl(sum(t.c802000005),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('自建子管'),t.c802000002 as 所属城市,nvl(sum(t.c802000006),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('租用管道'),t.c802000002 as 所属城市,nvl(sum(t.c802000010),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('租用管孔'),t.c802000002 as 所属城市,nvl(sum(t.c802000011),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('租用子管'),t.c802000002 as 所属城市,nvl(sum(t.c802000012),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('其他管道'),t.c802000002 as 所属城市,nvl(sum(t.c802000014),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('其他管孔'),t.c802000002 as 所属城市,nvl(sum(t.c802000015),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('其他子管'),t.c802000002 as 所属城市,nvl(sum(t.c802000016),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('合计管道'),t.c802000002 as 所属城市,nvl(sum(t.c802000020),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('合计管孔'),t.c802000002 as 所属城市,nvl(sum(t.c802000021),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				union all
				select trim('合计子管'),t.c802000002 as 所属城市,nvl(sum(t.c802000022),0) as num from {100} t 
				where 1=1 {5}
				group by t.c802000002
				
				
		]]></item>
	</sql>
</sql-group>


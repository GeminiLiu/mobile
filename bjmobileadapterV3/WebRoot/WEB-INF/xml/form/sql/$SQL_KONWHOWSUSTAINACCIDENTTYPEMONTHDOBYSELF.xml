<?xml version="1.0" encoding="GB2312"?>
<sql-group>
	<doc>
		<author>duanximeng</author>
		<date>2006-03-29</date>
		<description></description>
	</doc>
	
	<sql name="knowhowsustainaccidenttypemonthdobyself" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
ltrim('交换'),
'预处理工单数量',
nvl(count(distinct t.c1),0)
from 
{100} t
where t.c700000010='已关闭'
and t.c700000014='交换'
{5}
group by t.c700000014
union all
select 
ltrim('传输'),
'预处理工单数量',
nvl(count(distinct t.c1),0)
from 
{100} t
where t.c700000010='已关闭'
and t.c700000014='传输'
{5}
group by t.c700000014
union all
select 
distinct ltrim('数据'),
'预处理工单数量',
nvl(sum(count(distinct t.c1)),0)
from 
{100} t
where t.c700000010='已关闭'
and ( t.c700000014='IP承载网' or t.c700000014='CMNET' or t.c700000014='WLAN' or t.c700000014='WAP')
{5}
group by t.c700000014
union all
select 
ltrim('交换'),
'由省技术支援解决的问题工单数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='交换'
and p.c700020004='BEGIN'
and pp.c700020011='已派发'
{5}
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('传输'),
'由省技术支援解决的问题工单数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='传输'
and p.c700020004='BEGIN'
and pp.c700020011='已派发'
{5}
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
distinct ltrim('数据'),
'由省技术支援解决的问题工单数量',
nvl(sum(count(distinct t.c1)),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and ( t.c700000014='IP承载网' or t.c700000014='CMNET' or t.c700000014='WLAN' or t.c700000014='WAP')
and p.c700020004='BEGIN'
and pp.c700020011='已派发'
{5}
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('交换'),
'由厂家解决的问题数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='交换'
and p.c700020004='BEGIN'
{5}
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('传输'),
'由厂家解决的问题数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='传输'
and p.c700020004='BEGIN'
{5}
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
distinct ltrim('数据'),
'由厂家解决的问题数量',
nvl(sum(count(distinct t.c1)),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and ( t.c700000014='IP承载网' or t.c700000014='CMNET' or t.c700000014='WLAN' or t.c700000014='WAP')
and p.c700020004='BEGIN'
{5}
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('交换'),
'由厂家解决的问题最终定位_软件问题的数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='交换'
and t.c802000004='软件问题'
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('传输'),
'由厂家解决的问题最终定位_软件问题的数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='传输'
and t.c802000004='软件问题'
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
distinct ltrim('数据'),
'由厂家解决的问题最终定位_软件问题的数量',
nvl(sum(count(distinct t.c1)),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c802000004='软件问题'
and ( t.c700000014='IP承载网' or t.c700000014='CMNET' or t.c700000014='WLAN' or t.c700000014='WAP')
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('交换'),
'由厂家解决的问题最终定位_硬件问题的数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='交换'
and t.c802000004='硬件问题'
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('传输'),
'由厂家解决的问题最终定位_硬件问题的数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='传输'
and t.c802000004='硬件问题'
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
distinct ltrim('数据'),
'由厂家解决的问题最终定位_硬件问题的数量',
nvl(sum(count(distinct t.c1)),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c802000004='硬件问题'
and ( t.c700000014='IP承载网' or t.c700000014='CMNET' or t.c700000014='WLAN' or t.c700000014='WAP')
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('交换'),
'由厂家解决的问题最终定位_其他问题的数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='交换'
and (t.c802000004='软硬件问题' or t.c802000004='非软硬件问题')
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
ltrim('传输'),
'由厂家解决的问题最终定位_其他问题的数量',
nvl(count(distinct t.c1),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and t.c700000014='传输'
and (t.c802000004='软硬件问题' or t.c802000004='非软硬件问题')
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014
union all
select 
distinct ltrim('数据'),
'由厂家解决的问题最终定位_其他问题的数量',
nvl(sum(count(distinct t.c1)),0)
from 
{100} t,{200} p,{200} pp
where t.c700000010='已关闭'
and (t.c802000004='软硬件问题' or t.c802000004='非软硬件问题')
and ( t.c700000014='IP承载网' or t.c700000014='CMNET' or t.c700000014='WLAN' or t.c700000014='WAP')
{5}
and p.c700020004='BEGIN'
and not exists(
select distinct pp.c700020001
from {200} pp,{200} ppp
where
pp.c700020004='BEGIN'
and ppp.c700020011='已派发'
and ppp.c700020004=pp.c700020003
and t.c1 = pp.C700020001
and t.c1 = ppp.C700020001
and t.c700000001=pp.c700020002
and t.c700000001=ppp.c700020002
and pp.c700020002=p.C700020002
and ppp.c700020002=p.C700020002
)
and pp.c700020004=p.c700020003
and t.c1 = p.C700020001
and t.c1 = pp.C700020001
and t.c700000001=p.c700020002
and t.c700000001=pp.c700020002
group by t.c700000014



		]]></item>
	</sql>
	

</sql-group>


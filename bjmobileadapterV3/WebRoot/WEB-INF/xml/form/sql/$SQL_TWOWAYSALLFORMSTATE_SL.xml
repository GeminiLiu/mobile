<?xml version="1.0" encoding="GB2312"?>
<sql-group>
	<doc>
		<author>duanximeng</author>
		<date>2006-05-21</date>
		<description>
		</description>
	</doc>
	<!-- 派发人到受理人-->
	<sql name="hbeoms.twowaysallformstatepfrolenametorolename_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) || '' as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009

union all

select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'一般',
count(distinct(t.C1)) || '' as 一般
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='一般'

group by t.C700000004,pro.C700020009

union all

select 
a.人员派给人员, 
'一般比率', 
round(b.一般/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 一般比率 
from 
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'一般',
count(distinct(t.C1)) as 一般
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 

and t.c700000015='一般'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009) b
where a.人员派给人员=b.人员派给人员

union all

select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'次要',
count(distinct(t.C1)) || '' as 次要
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and t.c700000015='次要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009

union all

select 
a.人员派给人员, 
'次要比率', 
round(b.次要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 次要比率 
from
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'次要',
count(distinct(t.C1)) as 次要
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009) b
where a.人员派给人员=b.人员派给人员

union all

select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'重要',
count(distinct(t.C1)) || '' as 重要
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009

union all

select 
a.人员派给人员, 
'重要比率', 
round(b.重要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 重要比率 
from
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'重要',
count(distinct(t.C1)) as 重要
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='重要'
group by t.C700000004,pro.C700020009) b
where a.人员派给人员=b.人员派给人员

union all

select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'紧急',
count(distinct(t.C1)) || '' as 紧急
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='紧急'
group by t.C700000004,pro.C700020009

union all

select 
a.人员派给人员, 
'紧急比率', 
round(b.紧急/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 紧急比率 
from
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,pro.C700020009) a,
(select 
t.C700000004 || '-->' || pro.C700020009 as 人员派给人员,
'紧急',
count(distinct(t.C1)) as 紧急
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{300} uu
where
t.c700000004=u.c630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and pro.C700020009=uu.c630000003
and t.C1=pro.C700020001 
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='紧急'
group by t.C700000004,pro.C700020009) b
where a.人员派给人员=b.人员派给人员
		]]></item>
	</sql>
		<!-- 派发人到受理人-->
	<sql name="hbeoms.twowaysallformstatepfrolenametorolename_yrow_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
		select
(a.派单人||'-->'||
b.受理人) as 人派给人
from
(select distinct(u.c630000003) as 派单人 from {300} u where 1=1 {2}) a,
(select distinct(u.c630000003) as 受理人 from {300} u where 1=1 {4}) b
order by a.派单人
		]]></item>
	</sql>
	<!-- 派发人到受理部门
	t.c700000004=uu.c630000003
and uu.c1='000000000001942'
	 -->
		<sql name="hbeoms.twowaysallformstatesendpfrolenametosendscopename_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'工单总数',
count(distinct(t.C1)) || '' as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018

union all

select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'一般',
count(distinct(t.C1)) || '' as 一般
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
 {1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='一般'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018

union all

select 
a.人员派给部门, 
'一般比率', 
round(b.一般/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 一般比率 
from 
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) a,
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'一般',
count(distinct(t.C1)) as 一般
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='一般'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) b
where a.人员派给部门=b.人员派给部门

union all

select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'次要',
count(distinct(t.C1)) || '' as 次要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
 {1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='次要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018

union all

select 
a.人员派给部门, 
'次要比率', 
round(b.次要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 次要比率 
from
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) a,
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'次要',
count(distinct(t.C1)) as 次要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='次要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) b
where a.人员派给部门=b.人员派给部门

union all

select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'重要',
count(distinct(t.C1)) || '' as 重要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='重要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018

union all

select 
a.人员派给部门, 
'重要比率', 
round(b.重要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 重要比率 
from
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
 {1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) a,
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'重要',
count(distinct(t.C1)) as 重要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='重要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) b
where a.人员派给部门=b.人员派给部门

union all

select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'紧急',
count(distinct(t.C1)) || '' as 紧急
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='紧急'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018

union all

select 
a.人员派给部门, 
'紧急比率', 
round(b.紧急/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 紧急比率 
from
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and u.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) a,
(select 
t.C700000004 || '-->' || g.C630000018 as 人员派给部门,
'紧急',
count(distinct(t.C1)) as 紧急
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
 t.c700000004=uu.c630000003
 and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and u.C630000003=pro.C700020009
and t.c700000015='紧急'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by t.C700000004,g.C630000018) b
where a.人员派给部门=b.人员派给部门
		]]></item>
	</sql>
	<!-- 派发人到受理部门yrow -->
		<sql name="hbeoms.twowaysallformstatesendpfrolenametosendscopename_yrow_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
(a.派单人||'-->'||
b.受理组) as 人派给部门
from
(select distinct(uu.c630000003) as 派单人 from {300} uu where 1=1 {2}) a,
(select g.C630000018 as 受理组 from {400} g where 1=1 {4}) b
		]]></item>
	</sql>
	<!-- 派发组到受理人-->
		<sql name="hbeoms.twowaysallformstatepfsendscopenametorolename_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) || '' as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014

union all

select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'一般',
count(distinct(t.C1)) || '' as 一般
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='一般'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014

union all

select 
a.部门派给人员, 
'一般比率', 
round(b.一般/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 一般比率 
from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'一般',
count(distinct(t.C1)) as 一般
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='一般'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员
 
union all

select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'次要',
count(distinct(t.C1)) || '' as 次要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='次要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014

union all

select 
a.部门派给人员, 
'次要比率', 
round(b.次要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 次要比率 
from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'次要',
count(distinct(t.C1)) as 次要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='次要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员

union all

select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'重要',
count(distinct(t.C1)) || '' as 重要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='重要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014

union all

select 
a.部门派给人员, 
'重要比率', 
round(b.重要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 重要比率 
from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'重要',
count(distinct(t.C1)) as 重要
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='重要'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员

union all

select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'紧急',
count(distinct(t.C1)) || '' as 紧急
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='紧急'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014

union all

select 
a.部门派给人员, 
'紧急比率', 
round(b.紧急/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 紧急比率 
from 
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || pro.C700020009 as 部门派给人员,
'紧急',
count(distinct(t.C1)) as 紧急
from {1000} t,(select * from {900} union all select * from {800}) pro,{300} u,{400} g,{500} gu,{300} uu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
{1}{2}{3}{4}
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
and pro.C700020009=uu.c630000003
and t.c700000015='紧急'
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,pro.C700020009--,t.C700000014
) b
where a.部门派给人员=b.部门派给人员
		]]></item>
	</sql>
	<!-- 派发组到受理人yrow-->
		<sql name="hbeoms.twowaysallformstatepfsendscopenametorolename_yrow_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
(a.派单组||'-->'||
b.受理人) as 组派给人
from
(select g.C630000018 as 派单组 from {400} g where 1=1 {5}) a,
(select distinct(u.c630000003) as 受理人 from {300} u where 1=1 {6}) b
order by a.派单组
		]]></item>
	</sql>
	<!-- 派发组到受理组-->
		<sql name="hbeoms.twowaysallformstatesendpfscopenametoscopename_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) || '' as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003	
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,gg.C630000018--,t.C700000014

union all

select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'一般',
count(distinct(t.C1)) || '' as 一般
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='一般'
group by g.C630000018,gg.C630000018--,t.C700000014

union all

select 
a.部门派给部门, 
'一般比率', 
round(b.一般/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 一般比率 
from 
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,gg.C630000018--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'一般',
count(distinct(t.C1)) || '' as 一般
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='一般'
group by g.C630000018,gg.C630000018--,t.C700000014
) b
where a.部门派给部门=b.部门派给部门

union all

select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'次要',
count(distinct(t.C1)) || '' as 次要
from {1000} t,{800} pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='次要'
group by g.C630000018,gg.C630000018--,t.C700000014

union all

select 
a.部门派给部门, 
'次要比率', 
round(b.次要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 次要比率 
from
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,gg.C630000018--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'次要',
count(distinct(t.C1)) as 次要
from {1000} t,{800} pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='次要'
group by g.C630000018,gg.C630000018--,t.C700000014
) b
where a.部门派给部门=b.部门派给部门

union all

select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'重要',
count(distinct(t.C1)) || '' as 重要
from {1000} t,{800} pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='重要'
group by g.C630000018,gg.C630000018--,t.C700000014

union all

select 
a.部门派给部门, 
'重要比率', 
round(b.重要/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 重要比率 
from
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,gg.C630000018--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'重要',
count(distinct(t.C1)) as 重要
from {1000} t,{800} pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='重要'
group by g.C630000018,gg.C630000018--,t.C700000014
) b
where a.部门派给部门=b.部门派给部门

union all

select 
g.C630000018 || '-->' || gg.C630000018 as 受理组,
'紧急',
count(distinct(t.C1)) || '' as 紧急
from {1000} t,{800} pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='紧急'
group by g.C630000018,gg.C630000018--,t.C700000014

union all

select 
a.部门派给部门, 
'紧急比率', 
round(b.紧急/(case when a.工单总数=0 then 1 else a.工单总数 end),4)*100 || '%' as 紧急比率 
from
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'工单总数',
count(distinct(t.C1)) as 工单总数
from {1000} t,(select * from {800} union all select * from {900}) pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
group by g.C630000018,gg.C630000018--,t.C700000014
) a,
(select 
g.C630000018 || '-->' || gg.C630000018 as 部门派给部门,
'紧急',
count(distinct(t.C1)) as 紧急
from {1000} t,{800} pro,{300} u,{400} g,{500} gu,{300} uu,{400} gg,{500} gugu
where
t.c700000004=u.C630000003
and t.c700000001=pro.c700020002
and t.C1=pro.C700020001 
and g.C1=gu.C620000027
and gu.C620000028=u.C1
{1}{2}{3}{4}
and gg.C1=gugu.C620000027
and gugu.C620000028=uu.C1

and uu.C630000003=pro.C700020009
and pro.c700020011 in ('已完成','待受理','已派发','提交审批')
and t.c700000015='紧急'
group by g.C630000018,gg.C630000018--,t.C700000014
) b
where a.部门派给部门=b.部门派给部门


		]]></item>
	</sql>
		<!-- 派发组到受理部门yrow-->
		<sql name="hbeoms.twowaysallformstatesendpfscopenametoscopename_yrow_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
select
a.派单组||'-->'||b.受理组 as 部门派发部门
from
(select g.C630000018 as 派单组 from {400} g where 1=1 {5}) a,
(select gg.C630000018 as 受理组 from {400} gg where 1=1 {6}) b
		]]></item>
	</sql>
		<sql name="hbeoms.titlename_sl" datasource="Ultranms">
		<item dbms="All"><![CDATA[
  
select 't'||t.schemaid,BaseCategory.C650000001 as basechname, BaseCategory.C650000002 as basename from {500} BaseCategory,arschema t
where  t.name=BaseCategory.C650000002 and t.schemaid={5}
		]]></item>
	</sql>
</sql-group>


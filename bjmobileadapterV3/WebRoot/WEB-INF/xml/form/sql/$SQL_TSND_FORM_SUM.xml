<?xml version="1.0" encoding="GB2312"?>
<sql-group>
	<doc>
		<author>duanximeng</author>
		<date>2006-03-17</date>
		<description>投诉申告前后台处理统计from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
		{3} {5}
	</description>
	</doc>
	
	<sql name="Tsnd_form_sum" datasource="Ultranms">
		<item dbms="All"><![CDATA[
		select
distinct(a.处理客服) as 处理客服,
a.前台提交 as 提交,
b.前台直接处理 as 直接处理,
c.后台复核派单及时 as 复核派单及时,
d.后台复核派单超时 as 复核派单超时,
e.后台直接答复 as 直接答复,
f.派单及时 as 及时,
g.派单超时 as 超时,
h.处理及时 as 及时,
i.处理超时 as 超时,
j.反馈及时 as 及时,
k.反馈超时 as 超时,
l.总体考察及时 as 考察及时,
m.总体考察超时 as 考察超时
from
(select
b.处理客服,
nvl(a.前台提交,0) as 前台提交
from
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 前台提交   
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and comp.c700000001=pro.c700020002
          and pro.C700020004='BEGIN' 
         and pro.C700020019=0 and  pro.C700020022=0 and pro.c700020011='已提交复核'
          and g.C630000021<>7
          and comp.c700000010<>'已作废'
          and pro.c700020022=0
          and pro.c700020020<>6
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a,
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) a,

(select
b.处理客服,
nvl(a.前台直接处理,0) as 前台直接处理
from      
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 前台直接处理
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and pro.C700020004='BEGIN'and pro.C801000101=7 and g.C630000021<>7
          and comp.c700000010<>'已作废'
          and pro.c700020020<>6
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a, 
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服 ) b, 

(select
b.处理客服,
nvl(a.后台复核派单及时,0) as 后台复核派单及时
from                 
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 后台复核派单及时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and pro.C700020004='BEGIN'
          and (pro.c801000101=4 or pro.c801000101=2) 
          and pro.C700020017-pro.C700020014<=0 
          and comp.c700000010<>'已作废'
          and pro.c700020020<>6
          and pro.c801000103=0
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a, 
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) c,
          
(select
b.处理客服,
nvl(a.后台复核派单超时,0) as 后台复核派单超时
from              
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 后台复核派单超时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and pro.C700020004='BEGIN'
          and (pro.c801000101=4 or pro.c801000101=2) 
          and pro.C700020017-pro.C700020014>0 
          and pro.c801000103=0
          --and comp.c700000010<>'已作废'
          {3} {5}
          and pro.C700020010=u.C630000001
          and pro.c700020020<>6
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a,
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) d,

(select
b.处理客服,
nvl(a.后台直接答复,0) as 后台直接答复
from                     
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 后台直接答复
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
         
          where comp.C1 = pro.C700020001
           and pro.C700020010 = u.C630000001
           and u.C1 = gu.C620000028
           and u.C630000001 <> 'weizhiqiang'
           and u.C630000001 <> 'wzq'
           and gu.C620000027 = g.C1
           and pro.C700020019 = 20
           and pro.C700020022 = 0
           and pro.c700020020<>6
           and pro.C801000101 = 7
          
           
           {3} {5}
          group by comp.C801000018) a,
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) e,

(select
b.处理客服,
nvl(a.派单及时,0) as 派单及时
from                  
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 派单及时        
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and (pro.C801000101=1 or pro.C801000101=4) and pro.C700020017-pro.C700020014<=0
          and pro.c700020020<>6
          and comp.c700000010<>'已作废'
          and pro.c801000103=0
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a,  
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) f,
          
(select
b.处理客服,
nvl(a.派单超时,0) as 派单超时
from                  
(select
          distinct(comp.C801000018) as 处理客服,
           count(distinct(comp.c1)) as 派单超时         
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and (pro.C801000101=1 or pro.C801000101=4) and pro.C700020017-pro.C700020014>0
          and pro.c700020020<>6
          and comp.c700000010<>'已作废'
          and pro.c801000103=0
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a, 
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) g,
          
(select
b.处理客服,
nvl(a.处理及时,0) as 处理及时
from               
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 处理及时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and pro.C801000101 in (5,6,7,9) and pro.C700020017-pro.C700020014<=0
          and pro.c700020020<>6
          and comp.c700000010<>'已作废'
          and pro.c801000103=0
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a,
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) h,
          
(select
b.处理客服,
nvl(a.处理超时,0) as 处理超时
from                     
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1)) as 处理超时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and pro.C801000101 in (5,6,7,9) and pro.C700020017-pro.C700020014>0
          and pro.c700020020<>6
          and comp.c700000010<>'已作废'
          and pro.c801000103=0
          {3} {5}
          and pro.C700020010=u.C630000001
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a,  
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) i,
          
(select
b.处理客服,
nvl(a.反馈及时,0) as 反馈及时
from                 
(select
          distinct(comp.C801000018) as 处理客服,
          count(comp.c1) as 反馈及时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,
          (select * from T94 union all select * from T95) tt
          where
          comp.C1=pro.C700020001
          and comp.C700000005=u.C630000001
          and u.c630000013=g.c1
          and pro.C801000101=8 
          and pro.C700020019<>20 
          and pro.c700020003=tt.c700020004
          and pro.C700020017>tt.C700020017
          and pro.c700020020<>6
          and nvl(pro.C700020017,((to_date( to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'), 'yyyy-mm-dd hh24:mi:ss')-to_date('1970-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss')) * 3600 * 24))
                -tt.c700020017<=2*3600
          and pro.c801000103=0   
          and comp.c700000010<>'已作废'
          and g.C630000021='2'
		  and (g.c630000018<>'administrator')
		 and (g.C630000018 <>'神州泰岳')
		 and (g.C630000018 <>'河北移动通讯股份有限公司')
          {3} {5}
          --and pro.C700020010=u.C630000001
          --and u.C1=gu.C620000028
          --and gu.C620000027=g.C1
          group by comp.C801000018) a,
           (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) j,

(select
b.处理客服,
nvl(a.反馈超时,0) as 反馈超时
from        
(select
          distinct(comp.C801000018) as 处理客服,
          count(comp.c1) as 反馈超时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,
          (select * from T94 union all select * from T95) tt
          where
          comp.C1=pro.C700020001
          and comp.C700000005=u.C630000001
          and u.c630000013=g.c1
          and pro.C801000101=8 
          and pro.C700020019<>20 
          and pro.c700020003=tt.c700020004
          and pro.C700020017>tt.C700020017
          and pro.c700020020<>6
          and nvl(pro.C700020017,((to_date( to_char(sysdate,'yyyy-mm-dd hh24:mi:ss'), 'yyyy-mm-dd hh24:mi:ss')-to_date('1970-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss')) * 3600 * 24))
                -tt.c700020017>2*3600
           and pro.c801000103=0     
          and comp.c700000010<>'已作废'
            and g.C630000021='2'
			 and (g.c630000018<>'administrator')
			and (g.C630000018 <>'神州泰岳')
			and (g.C630000018 <>'河北移动通讯股份有限公司')
          {3} {5}
          --and pro.C700020010=u.C630000001
          --and u.C1=gu.C620000028
          --and gu.C620000027=g.C1
          group by comp.C801000018) a,
           (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) k,

(select
b.处理客服,
nvl(a.总体考察及时,0) as 总体考察及时
from                
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1))  as 总体考察及时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and comp.C700000006+comp.C801800015*1800-comp.C700000008>=0
          and comp.c700000010<>'已作废'
          {3} {5}
          and pro.C700020010=u.C630000001
          and pro.c700020020<>6
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          and pro.c801000103=0
          group by comp.C801000018) a,  
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) l,
 
(select
b.处理客服,
nvl(a.总体考察超时,0) as 总体考察超时
from               
(select
          distinct(comp.C801000018) as 处理客服,
          count(distinct(comp.c1))  as 总体考察超时
          from {100} comp,(select * from {200} union all select * from {300}) pro,{500} u,{400} g,{600} gu
          where
          comp.C1=pro.C700020001
          and comp.C700000006+comp.C801800015*1800-comp.C700000008<0
          and comp.c700000010<>'已作废'
          {3} {5}
          and pro.c801000103=0
          and pro.C700020010=u.C630000001
          and pro.c700020020<>6
          and u.C1=gu.C620000028
          and gu.C620000027=g.C1
          group by comp.C801000018) a,
          (select distinct city.c801800001 as 处理客服 from {800} city where city.c801800001!='集团') b
          where a.处理客服(+)=b.处理客服) m
          where a.处理客服=b.处理客服
          and b.处理客服=c.处理客服
          and c.处理客服=d.处理客服
          and d.处理客服=e.处理客服
          and e.处理客服=f.处理客服
          and f.处理客服=g.处理客服
          and g.处理客服=h.处理客服
          and h.处理客服=i.处理客服
          and i.处理客服=j.处理客服
          and j.处理客服=k.处理客服
          and k.处理客服=l.处理客服
          and l.处理客服=m.处理客服

		]]></item>
	</sql>
</sql-group>


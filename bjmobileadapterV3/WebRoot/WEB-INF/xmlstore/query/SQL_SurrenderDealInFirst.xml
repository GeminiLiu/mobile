<?xml version="1.0" encoding="UTF-8"?>
<sql-group>
	<doc>
		<author>作者</author> 
		<date>时间</date> 
		<description>Sql 描述</description> 		
	</doc>
	<sqlquery name="kpi.surrender.dealInFirst" dbpoolname="orapool">
		<select>
		<![CDATA[
			select 
       		#persongroupfieldname# bmName,
       		#persongroupfieldid# gid,
       			sum(case
		             when tSurrender.C800021004 = '一级处理完成' then
		              1
		             else
		              0
		           end) 一级解决工单,
		       count(distinct dp2.c700020001) 工单总数
		  from {WF:EL_TTM_CCH} tSurrender,{WF:App_DealProcess} dp2
		 where dp2.c700020002 = 'WF:EL_TTM_CCH'
		   and dp2.c700020002 = tSurrender.c700000001
		   and dp2.c700020001 = tSurrender.c1
		   and dp2.c700020077 =1
		   and (tSurrender.c700000010 = '已归档' or
		               tSurrender.c700000010 = '处理完成待归档')
		   and dp2.c700020003 = 'dp_2'
		   and dp2.c700020017 > 0
		   and tSurrender.c800030007 not like '%网络覆盖%' 
		   and tSurrender.c800030007 not like '%通话质量%'
		   #persongroup#
		   #seltime#
           group by #persongroupfieldname#,#persongroupfieldid#
		  ]]> 
		</select>
		<rptatribute>
			<title>
				<item>		
					<titlecol>
						<text>名称</text>						
					</titlecol>
					<titlecol>
						<isshow>false</isshow>
					</titlecol>		
					<titlecol>
						<text>一级解决工单</text>
						<urltemp><![CDATA[GetDetail.jsp?name=#title#&sql=kpi.surrender.dealInFirstDetail&start=#start#&end=#end#&selround=#selround#&gid=$gid$&persongroupfieldname=$bmName$]]> </urltemp>
					</titlecol>
					<titlecol>
						<text>工单总数</text>
						<urltemp><![CDATA[GetDetail.jsp?name=#titleTotal#&sql=kpi.surrender.dealInFirstTotalDetail&start=#start#&end=#end#&selround=#selround#&gid=$gid$&persongroupfieldname=$bmName$]]> </urltemp>
					</titlecol>
					<titlecol>
						<text>一级解决率</text>
					</titlecol>			
				</item>				
			</title>
			<sumitem>
				<item>				
					<sum type="ROW">
						<groupbycol></groupbycol>
						<sumcol>2,3</sumcol>
						<sumtext>合计</sumtext>
					</sum>
				</item>
			</sumitem>
			<calcol>
				<item>
					<colname1>一级解决工单</colname1>
					<colname2>工单总数</colname2>					
					<expression>DIV</expression>
					<percent>100</percent>
					<scale>2</scale>
				</item>
			</calcol>	
		</rptatribute>
	</sqlquery>
	
	<sqlquery name="kpi.surrender.dealInFirstDetail" dbpoolname="orapool">
		<select>
		<![CDATA[ 
		select
			/*COUNT*/
			 tSurrender.baseid baseid,
			 tSurrender.liushuihao as 流水号,
			 tSurrender.jiandanshijian 建单时间,
			 tSurrender.jiandanren as 建单人,
			 tSurrender.zhuti as 主题,
			 tSurrender.gaojing as 告警级别,
			 tSurrender.zhuanye as 所属专业,
			 tSurrender.zhuangtai as 工单状态
			/*COUNT*/
   		  from ( select
			 distinct tSurrender.c1 baseid,
			 tSurrender.c700000003 as liushuihao,
			 to_char(TO_DATE('19700101', 'yyyymmdd') + tSurrender.c700000006 / 86400 +
			         8 / 24,
			         'yyyy-mm-dd hh24:MI:ss') jiandanshijian,
			 tSurrender.c700000004 as jiandanren,
			 tSurrender.c700000011 as zhuti,
			 tSurrender.c800020027 as gaojing,
			 tSurrender.c700000014 as zhuanye,
			 tSurrender.c700000010 as zhuangtai
			  from {WF:EL_TTM_CCH} tSurrender, {WF:App_DealProcess} dp2
			 where dp2.c700020002 = 'WF:EL_TTM_CCH'
			   and dp2.c700020001 = tSurrender.c1
			   and dp2.c700020002 = tSurrender.c700000001
			   and tSurrender.C800021004 = '一级处理完成'
			   and dp2.c700020003 = 'dp_2'
			   and dp2.c700020077 = '1'
			   and dp2.c700020017 > 0
			   and (tSurrender.c700000010 = '已归档' or
			       tSurrender.c700000010 = '处理完成待归档')
			   and c800030007 not like '%网络覆盖%' 
               and c800030007 not like '%通话质量%'
			   #persongroupfieldid#
			   #seltime#
			   ) tSurrender
			   order by tSurrender.jiandanshijian desc
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>					
					<titlecol>	
						<isshow>false</isshow>
					</titlecol>						
					<titlecol>
						<text>流水号</text>
					</titlecol>
					<titlecol>
						<text>建单时间</text>
					</titlecol>
					<titlecol>
						<text>建单人</text>
					</titlecol>
					<titlecol>						
						<urltemp><![CDATA[http://#serveraddress#/arsys/servlet/ViewFormServlet?server=#remedyserver#&form=WF:EL_TTM_CCH&mode=QUERY&eid=$baseid$&view=&]]></urltemp>
						<text>主题</text>						
					</titlecol>					
				</item>
			</title>			
		</rptatribute>
	</sqlquery>

	<sqlquery name="kpi.surrender.dealInFirstTotalDetail" dbpoolname="orapool">
		<select>
		<![CDATA[
		 select
			/*COUNT*/
			 tSurrender.baseid baseid,
			 tSurrender.liushuihao as 流水号,
			 tSurrender.jiandanshijian 建单时间,
			 tSurrender.jiandanren as 建单人,
			 tSurrender.zhuti as 主题,
			 tSurrender.gaojing as 告警级别,
			 tSurrender.zhuanye as 所属专业,
			 tSurrender.zhuangtai as 工单状态
			/*COUNT*/
   		  from ( select
			 distinct tSurrender.c1 baseid,
			 tSurrender.c700000003 as liushuihao,
			 to_char(TO_DATE('19700101', 'yyyymmdd') + tSurrender.c700000006 / 86400 +
			         8 / 24,
			         'yyyy-mm-dd hh24:MI:ss') jiandanshijian,
			 tSurrender.c700000004 as jiandanren,
			 tSurrender.c700000011 as zhuti,
			 tSurrender.c800020027 as gaojing,
			 tSurrender.c700000014 as zhuanye,
			 tSurrender.c700000010 as zhuangtai
			  from {WF:App_DealProcess} dp2,{WF:EL_TTM_CCH} tSurrender
			 where dp2.c700020002 = 'WF:EL_TTM_CCH'
			   and dp2.c700020077 = '1'
			   and dp2.c700020003 = 'dp_2'
			   #persongroupfieldid#
			   and dp2.c700020001 = tSurrender.c1
			   and dp2.c700020002 = tSurrender.c700000001
			   and dp2.c700020017 > 0
			   and (tSurrender.c700000010 = '已归档' or
			       tSurrender.c700000010 = '处理完成待归档')
			   and c800030007 not like '%网络覆盖%' 
           	   and c800030007 not like '%通话质量%'
			 #seltime#
			 ) tSurrender
			   order by tSurrender.jiandanshijian desc
		 ]]> 
		</select>	
		<rptatribute>
			<title>
				<item>					
					<titlecol>	
						<isshow>false</isshow>
					</titlecol>						
					<titlecol>
						<text>流水号</text>
					</titlecol>
					<titlecol>
						<text>建单时间</text>
					</titlecol>
					<titlecol>
						<text>建单人</text>
					</titlecol>
					<titlecol>						
						<urltemp><![CDATA[http://#serveraddress#/arsys/servlet/ViewFormServlet?server=#remedyserver#&form=WF:EL_TTM_CCH&mode=QUERY&eid=$baseid$&view=&]]></urltemp>
						<text>主题</text>						
					</titlecol>					
				</item>
			</title>			
		</rptatribute>	
	</sqlquery>








	<sqlquery name="kpi.surrender.dealInFirstWait" dbpoolname="orapool">
		<select>
		<![CDATA[
			select 
       		#persongroupfieldname# bmName,
       		#persongroupfieldid# gid,
       			sum(case
		             when tSurrender.C800021004 = '一级处理完成' then
		              1
		             else
		              0
		           end) 一级解决工单,
		       count(distinct dp2.c700020001) 工单总数
		  from {WF:EL_TTM_CCH} tSurrender,{WF:App_DealProcess} dp2
		 where dp2.c700020002 = 'WF:EL_TTM_CCH'
		   and dp2.c700020002 = tSurrender.c700000001
		   and dp2.c700020001 = tSurrender.c1
		   and dp2.c700020077 =1
		   and (tSurrender.c700000010 = '已归档' or
		               tSurrender.c700000010 = '处理完成待归档'  or   tSurrender.c700000010 = '待归档')
		   and dp2.c700020003 = 'dp_2'
		   and dp2.c700020017 > 0
		   and tSurrender.c800030007 not like '%网络覆盖%' 
		   and tSurrender.c800030007 not like '%通话质量%'
		   #persongroup#
		   and  tSurrender.C1 in  (select t.c700020001
                            from T331 t
                            where t.c700020003 = 'dp_7'  and t.C700020077 = 1
				            #seltime#)
           group by #persongroupfieldname#,#persongroupfieldid#
		  ]]> 
		</select>
		<rptatribute>
			<title>
				<item>		
					<titlecol>
						<text>名称</text>						
					</titlecol>
					<titlecol>
						<isshow>false</isshow>
					</titlecol>		
					<titlecol>
						<text>一级解决工单</text>
						<urltemp><![CDATA[GetDetailWait.jsp?name=#title#&sql=kpi.surrender.dealInFirstDetailWait&start=#start#&end=#end#&selround=#selround#&gid=$gid$&persongroupfieldname=$bmName$]]> </urltemp>
					</titlecol>
					<titlecol>
						<text>工单总数</text>
						<urltemp><![CDATA[GetDetailWait.jsp?name=#titleTotal#&sql=kpi.surrender.dealInFirstTotalDetailWait&start=#start#&end=#end#&selround=#selround#&gid=$gid$&persongroupfieldname=$bmName$]]> </urltemp>
					</titlecol>
					<titlecol>
						<text>一级解决率</text>
					</titlecol>			
				</item>				
			</title>
			<sumitem>
				<item>				
					<sum type="ROW">
						<groupbycol></groupbycol>
						<sumcol>2,3</sumcol>
						<sumtext>合计</sumtext>
					</sum>
				</item>
			</sumitem>
			<calcol>
				<item>
					<colname1>一级解决工单</colname1>
					<colname2>工单总数</colname2>					
					<expression>DIV</expression>
					<percent>100</percent>
					<scale>2</scale>
				</item>
			</calcol>	
		</rptatribute>
	</sqlquery>
	
	<sqlquery name="kpi.surrender.dealInFirstDetailWait" dbpoolname="orapool">
		<select>
		<![CDATA[ 
		select
			/*COUNT*/
			 tSurrender.baseid baseid,
			 tSurrender.liushuihao as 流水号,
			 tSurrender.jiandanshijian 建单时间,
			 tSurrender.jiandanren as 建单人,
			 tSurrender.zhuti as 主题,
			 tSurrender.gaojing as 告警级别,
			 tSurrender.zhuanye as 所属专业,
			 tSurrender.zhuangtai as 工单状态
			/*COUNT*/
   		  from ( select
			 distinct tSurrender.c1 baseid,
			 tSurrender.c700000003 as liushuihao,
			 to_char(TO_DATE('19700101', 'yyyymmdd') + tSurrender.c700000006 / 86400 +
			         8 / 24,
			         'yyyy-mm-dd hh24:MI:ss') jiandanshijian,
			 tSurrender.c700000004 as jiandanren,
			 tSurrender.c700000011 as zhuti,
			 tSurrender.c800020027 as gaojing,
			 tSurrender.c700000014 as zhuanye,
			 tSurrender.c700000010 as zhuangtai
			  from {WF:EL_TTM_CCH} tSurrender, {WF:App_DealProcess} dp2
			 where dp2.c700020002 = 'WF:EL_TTM_CCH'
			   and dp2.c700020001 = tSurrender.c1
			   and dp2.c700020002 = tSurrender.c700000001
			   and tSurrender.C800021004 = '一级处理完成'
			   and dp2.c700020003 = 'dp_2'
			   and dp2.c700020077 = '1'
			   and dp2.c700020017 > 0
			   and (tSurrender.c700000010 = '已归档' or
			       tSurrender.c700000010 = '处理完成待归档' or tSurrender.c700000010 = '待归档')
			   and c800030007 not like '%网络覆盖%' 
               and c800030007 not like '%通话质量%'
			   #persongroupfieldid#
			   and  tSurrender.C1 in  (select t.c700020001
                            from T331 t
                            where t.c700020003 = 'dp_7'  and t.C700020077 = 1
				            #seltime#)
			   ) tSurrender
			   order by tSurrender.jiandanshijian desc
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>					
					<titlecol>	
						<isshow>false</isshow>
					</titlecol>						
					<titlecol>
						<text>流水号</text>
					</titlecol>
					<titlecol>
						<text>建单时间</text>
					</titlecol>
					<titlecol>
						<text>建单人</text>
					</titlecol>
					<titlecol>						
						<urltemp><![CDATA[http://#serveraddress#/arsys/servlet/ViewFormServlet?server=#remedyserver#&form=WF:EL_TTM_CCH&mode=QUERY&eid=$baseid$&view=&]]></urltemp>
						<text>主题</text>						
					</titlecol>					
				</item>
			</title>			
		</rptatribute>
	</sqlquery>

	<sqlquery name="kpi.surrender.dealInFirstTotalDetailWait" dbpoolname="orapool">
		<select>
		<![CDATA[
		 select
			/*COUNT*/
			 tSurrender.baseid baseid,
			 tSurrender.liushuihao as 流水号,
			 tSurrender.jiandanshijian 建单时间,
			 tSurrender.jiandanren as 建单人,
			 tSurrender.zhuti as 主题,
			 tSurrender.gaojing as 告警级别,
			 tSurrender.zhuanye as 所属专业,
			 tSurrender.zhuangtai as 工单状态
			/*COUNT*/
   		  from ( select
			 distinct tSurrender.c1 baseid,
			 tSurrender.c700000003 as liushuihao,
			 to_char(TO_DATE('19700101', 'yyyymmdd') + tSurrender.c700000006 / 86400 +
			         8 / 24,
			         'yyyy-mm-dd hh24:MI:ss') jiandanshijian,
			 tSurrender.c700000004 as jiandanren,
			 tSurrender.c700000011 as zhuti,
			 tSurrender.c800020027 as gaojing,
			 tSurrender.c700000014 as zhuanye,
			 tSurrender.c700000010 as zhuangtai
			  from {WF:App_DealProcess} dp2,{WF:EL_TTM_CCH} tSurrender
			 where dp2.c700020002 = 'WF:EL_TTM_CCH'
			   and dp2.c700020077 = '1'
			   and dp2.c700020003 = 'dp_2'
			   #persongroupfieldid#
			   and dp2.c700020001 = tSurrender.c1
			   and dp2.c700020002 = tSurrender.c700000001
			   and dp2.c700020017 > 0
			   and (tSurrender.c700000010 = '已归档' or
			       tSurrender.c700000010 = '处理完成待归档'  or  tSurrender.c700000010 = '待归档')
			   and c800030007 not like '%网络覆盖%' 
           	   and c800030007 not like '%通话质量%'
			 and  tSurrender.C1 in  (select t.c700020001
                            from T331 t
                            where t.c700020003 = 'dp_7'  and t.C700020077 = 1
				            #seltime#)
			 ) tSurrender
			   order by tSurrender.jiandanshijian desc
		 ]]> 
		</select>	
		<rptatribute>
			<title>
				<item>					
					<titlecol>	
						<isshow>false</isshow>
					</titlecol>						
					<titlecol>
						<text>流水号</text>
					</titlecol>
					<titlecol>
						<text>建单时间</text>
					</titlecol>
					<titlecol>
						<text>建单人</text>
					</titlecol>
					<titlecol>						
						<urltemp><![CDATA[http://#serveraddress#/arsys/servlet/ViewFormServlet?server=#remedyserver#&form=WF:EL_TTM_CCH&mode=QUERY&eid=$baseid$&view=&]]></urltemp>
						<text>主题</text>						
					</titlecol>					
				</item>
			</title>			
		</rptatribute>	
	</sqlquery>
	</sql-group>
<?xml version="1.0" encoding="UTF-8"?>
<sql-group>
	<doc>
		<author>csl</author> 
		<date>2010-12-31</date> 
		<description>工作量统计转取</description> 		
	</doc>
	<sqlquery name="SQL_workLoadStatistics_Type_TTH1" dbpoolname="">
		<select>
		<![CDATA[
			select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
					 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select 
					
				   t.c1 as id, 
				   t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
				    
			  from {WF:App_DealProcessLog} dl,
			       {WF:EL_TTM_TTH} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dl.c700020407 = t.c1
			   and dl.c700020408 = t.c700000001
			   #createtime#
			   #tth#
			   and dl.c700020404 = po.loginname
			 group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
			  ]]>
		</select>	
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_workLoadStatistics_Type_TTH" dbpoolname="">
		<select>
		<![CDATA[
			select  /*COUNT*/
					nc.loginname,
					nc.fullname,
					nc.id, 
					nc.BaseSN,
				    nc.BaseSummary,
				    nc.BaseCreatorFullName,
				    to_char(to_date('19700101', 'yyyymmdd') +
						nc.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
				    as BaseCreateDate,
				    nc.BaseStatus 
			 /*COUNT*/
			from
			(select 
			 		po.loginname as loginname, 
			 		po.fullname as fullname,
					t.c1 as id, 
					t.c700000003 as BaseSN,
				    t.c700000011 as BaseSummary,
				    t.c700000004 as BaseCreatorFullName,
					t.c700000006 as BaseCreateDate,
				    t.c700000010 as BaseStatus-- dp.c700020003 as hjh, dp.c700020011 as hjzt
			  from {WF:App_DealProcess} dp,
			       {WF:EL_TTM_TTH} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dp.c700020001 = t.c1
			   and dp.c700020002 = t.c700000001
			   #tth#
			   #createtime#
			   and (dp.c700020003 = 'dp_1' or dp.c700020003 = 'dp_2' or dp.c700020003 = 'dp_4' or dp.c700020003 = 'dp_6' or dp.c700020003 = 'dp_7')
			   and dp.c700020010 = po.loginname
			   group by t.c1, po.loginname,po.fullname,t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003
			 ) nc

			  ]]>
		</select>	
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
				
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_workLoadStatistics_Type_TSK_XJ" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
					 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select  
					t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcess} dp,
			       {WF:EL_UVS_TSK_NX} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dp.c700020001 = t.c1
			   and dp.c700020002 = t.c700000001
			   #createtime#
			   and dp.c700020004 = 'BEGIN'
			   and dp.c700020022 <> 1
			   and dp.c700020010 = po.loginname
			   group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs

			  ]]>
		</select>	
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	
	<sqlquery name="SQL_workLoadStatistics_Type_TSK" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
					 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select  
				   t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcess} dp,
			       {WF:EL_UVS_TSK_NX} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dp.c700020001 = t.c1
			   and dp.c700020002 = t.c700000001
			   #tsk#
			   #createtime#
			   $con_time$
			   and dp.c700020010 = po.loginname
			   group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
			  ]]>
		</select>	
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_workLoadStatistics_Type_TSK_cb" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
					 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select 
					t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcessLog} dl,
			       {WF:EL_UVS_TSK_NX} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dl.c700020407 = t.c1
			   and dl.c700020408 = t.c700000001
			   #createtime#
			   $con_time$
			   and dl.c700020402 = '催办'
			   and dl.c700020404 = po.loginname
			   group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
			  ]]>
		</select>	
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_WorkLoadStatistics_tpye_cch1" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
					 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select 
				   t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcessLog} dl,
			       {WF:EL_TTM_CCH} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dl.c700020407 = t.c1
			   and dl.c700020408 = t.c700000001
			   #cch#
			   #createtime#
			   and dl.c700020404 = po.loginname
			   group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_WorkLoadStatistics_tpye_cch" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
						 	 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select    t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcess} dp,
			       {WF:EL_TTM_CCH} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dp.c700020001 = t.c1
			   and dp.c700020002 = t.c700000001
			   #createtime#
			   #cch#
			   and (dp.c700020003 = 'dp_2' or dp.c700020003 = 'dp_5' or dp.c700020003 = 'dp_7')
			   and dp.c700020010 = po.loginname
			   group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_WorkLoadStatistics_tpye_math" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
								as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
		(select 
		 			t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcess} dp,
			       {WF:EL_LCT_Math} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dp.c700020001 = t.c1
			   and dp.c700020002 = t.c700000001
			   #createtime#
			   #math#
			   and dp.c700020010 = po.loginname
			   group by t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_WorkLoadStatistics_tpye_math_sl" dbpoolname="">
		<select>
		<![CDATA[
		select   /*COUNT*/
					rs.id as id,
					rs.BaseSN as BaseSN,
					rs.BaseSummary as BaseSummary,
					rs.BaseCreatorFullName as BaseCreatorFullName,
					to_char(to_date('19700101', 'yyyymmdd') +
						rs.BaseCreateDate / 86400 + 8 / 24,
						'yyyy-mm-dd hh24:MI:ss')
							 as BaseCreateDate,
					rs.BaseStatus as BaseStatus
					/*COUNT*/
			from 
			(select  
					t.c1 as id, t.c700000003 as BaseSN,
				   t.c700000011 as BaseSummary,
 				   t.c700000004 as BaseCreatorFullName,
				   t.c700000006 as BaseCreateDate,
				   t.c700000010 as BaseStatus
			  from {WF:App_DealProcessLog} dl,
			       {WF:EL_LCT_Math} t,
			       (select cc.user_id    as id,
			               su.c630000001 as loginname,
			               su.c630000003 as fullname
			          from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			         where dc.calendar_id = cc.calendar_id
			           and cc.user_id = su.c630000029
			           #userName#
			           #createdate#
			         group by cc.user_id, su.c630000001, su.c630000003) po
			 where dl.c700020407 = t.c1
			   and dl.c700020408 = t.c700000001
			   #createtime#
			   and dl.c700020402 = '受理'
			   and dl.c700020404 = po.loginname
			   group by  t.c1, t.c700000010,t.c700000006, t.c700000004,t.c700000011,t.c700000003)rs
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
	<sqlquery name="SQL_WorkLoadStatistics_tpye_app" dbpoolname="">
		<select>
		<![CDATA[
		select  
				 /*COUNT*/
				apc.PHONE_COMPLAIN_ID as id,
			    apc.PHONE_COMPLAIN_ID as BaseSN,
 				apc.CREATE_NAME as BaseCreatorFullName,
				apc.CREATE_TIME as BaseCreateDate,
				apc.RESULT as BaseStatus
				 /*COUNT*/
			   from app_phone_complain apc,
			        (select cc.user_id    as id,
			                su.c630000001 as loginname,
			                su.c630000003 as fullname
			           from duty_calendar dc, cnt_calendar cc, {UltraProcess:SysUser} su
			          where dc.calendar_id = cc.calendar_id
			            and cc.user_id = su.c630000029
			            #userName#
			            #createdate#
			          group by cc.user_id, su.c630000001, su.c630000003) po
			  where ltrim(apc.create_id, 0) = po.id
			    and apc.result = 1
			    and apc.state = 1
			    #noformstime#
			 
		  ]]>
		</select>
		<rptatribute>
			<title>
				<item>
				<titlecol>	
					<isshow>false</isshow>
				</titlecol>	
				<titlecol>
					<text>工单流水号</text>
				</titlecol>	
				<titlecol>
					<text>工单主题</text>
				</titlecol>	
				<titlecol>
					<text>建单人</text>
				</titlecol>	
				<titlecol>
					<text>建单时间</text>
				</titlecol>		
				<titlecol>
					<text>工单状态</text>
				</titlecol>	
				</item>	
			</title>
			
		</rptatribute>
	</sqlquery>
</sql-group>